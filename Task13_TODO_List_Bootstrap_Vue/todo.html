<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Задача "TODO List Vue"</title>
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="todo.css">
</head>

<body>
<div class="container todo_container">
    <div class="row" id="App">
        <div class="col-sm-12 col-md-3 todo_add-form-col">
            <div class="todo_delete-form">
                <button type="button" class="todo_delete-all-btn btn btn-secondary" id="todo_delete-all-btn"
                        title="Удалить все задачи из списка задач" @click="removeAllTasks">Удалить все задачи
                </button>
            </div>
            <div class="todo_add-form form-group">
                <label for="todo_add-task_text">Новая задача</label>
                <textarea name="task-text" id="todo_add-task_text" class="form-control todo_text-area"
                          placeholder=" Сделать..."
                          data-toggle="tooltip" data-placement="auto"
                          title="Сформулируйте задачу" v-model="newTaskText"></textarea>
                <div class="invalid-feedback">
                    Отсутствует текст задачи
                </div>
                <button type="button" class="btn btn-primary" id="todo_add-task_btn" @click.stop.prevent="addTask"
                        title="Добавить новую задачу в список задач">Добавить
                </button>
            </div>
        </div>
        <div class="col-sm-12 col-md-9">
            <table class="table table-sm table-striped table-hover todo_table">
                <thead class="thead">
                <tr>
                    <th class="todo_col-date">Дата</th>
                    <th>Задача</th>
                    <th class="todo_col-button"></th>
                    <th class="todo_col-button"></th>
                </tr>
                </thead>
                <tbody id="todo_tbody">
                <tr v-for="(task, index) in tasks" :key="task.id">
                    <td>{{task.time}}</td>
                    <td>{{task.text}}</td>
                    <td>
                        <button type="button" class="button btn btn-primary" @click="editId=task.id; editTask;">
                            Изменить
                        </button>
                    </td>
                    <td>
                        <button type="button" class="button btn btn-primary" @click="removeId=task.id; removeTask;">
                            Удалить
                        </button>
                    </td>
                </tr>
                </tbody>
                <tfoot class="tfoot">
                <tr>
                    <th class="todo_col-date">Дата</th>
                    <th>Задача</th>
                    <th class="todo_col-button"></th>
                    <th class="todo_col-button"></th>
                </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>

<div id="confirm-dialog" class="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Запрос подтверждения</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body" id="confirm-dialog_message">
            </div>
            <div class="modal-footer">
                <button type="button" class="button btn btn-secondary" data-dismiss="modal">Отменить</button>
                <button type="button" class="button btn btn-primary" id="confirm-dialog_ok">Подтвердить</button>
            </div>
        </div>
    </div>
</div>

<div id="edit-dialog" class="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Изменение текста задачи</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="edit-task_text">Измените текст задачи</label>
                    <textarea name="task-text" id="edit-task_text" class="form-control todo_text-area"></textarea>
                    <div class="invalid-feedback">
                        Отсутствует текст задачи
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="button btn btn-secondary" data-dismiss="modal">Отменить</button>
                <button type="button" class="button btn btn-primary" id="edit-dialog_ok">Применить</button>
            </div>
        </div>
    </div>
</div>

<script src="node_modules/jquery/dist/jquery.js"></script>
<script src="node_modules/bootstrap/dist/js/bootstrap.bundle.js"></script>
<script src="node_modules/vue/dist/vue.js"></script>
<!--script src="todo.js"></script-->
<script>
    var textAddTask = $("#todo_add-task_text");

    function getDateAndTime() {
        var date = new Date();
        var month = date.getMonth() + 1;
        if (month < 10) {
            month = "0" + month;
        }
        var minutes = date.getMinutes();
        if (minutes < 10) {
            minutes = "0" + minutes;
        }
        var seconds = date.getSeconds();
        if (seconds < 10) {
            seconds = "0" + seconds;
        }
        var createDate = date.getDate() + "." + month + "." + date.getFullYear();
        var createTime = date.getHours() + ":" + minutes + ":" + seconds;

        return createDate + "\n" + createTime;
    }

    var app = new Vue({
        el: App,
        data: {
            tasks: [],
            newTaskText: "",
            id: 0,
            editId: 0,
            removeId: 0
        },
        methods: {
            addTask: function () {
                this.id++;
                var taskTime = getDateAndTime();
                var newTask = {
                    id: this.id,
                    time: taskTime,
                    text: this.newTaskText
                };
                this.newTaskText = "";
                this.tasks.push(newTask);

                $("#todo_add-task_text").focus();
            },
            removeAllTasks: function () {
                this.tasks = [];
            },
            removeTask: function () {
                this.tasks = this.tasks.filter(function (task) {
                    return task.id !== this.removeId;
                });
            }
        }
    });
</script>
</body>

</html>